(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{177:function(e,t,n){},313:function(e,t,n){e.exports=n(802)},391:function(e,t){},393:function(e,t){},413:function(e,t){},416:function(e,t){},669:function(e,t){},802:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(49),s=n.n(o),i=(n(177),n(308)),l=n(59),c=n(19),u=n.n(c),m=n(300),p=n.n(m),y=c.Connectors.InjectedConnector,d=c.Connectors.NetworkOnlyConnector,b=c.Connectors.PortisConnector,f={Injected:new y({supportedNetworks:[1,3,4]}),Network:new d({providerURL:"https://ropsten.infura.io/v3/c4809a978c5b48c8a5b8fdc9133cef42"}),Portis:new b({api:p.a,dAppId:"c5ae5710-95ad-43ff-8d6b-e7657ab429b4",network:"ropsten"})},h=n(15),g=n(804),v=n(805),w=n(806),E=n(808);var x=function(e){var t=Object(c.useWeb3Context)(),n=Object(a.useState)(!0),o=Object(h.a)(n,2),s=o[0],i=o[1];return console.log(Object.keys(f)),"router"===e.source&&t.setConnector("Network"),t.error&&console.error("Error!"),"router"===e.source?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,null,r.a.createElement("div",{className:"container text-center"},!t.active&&r.a.createElement(v.a,{style:{display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement(w.a,{onClick:function(){return t.setConnector("Injected")}},"Metamask"),r.a.createElement(w.a,{onClick:function(){return t.setConnector("Portis")}},"Portis")))),r.a.createElement(g.a,null,r.a.createElement("div",{className:"container text-center"},t.error&&r.a.createElement("p",null,"Something went wrong.  Please refresh the page and unlock Metamask or Portis again."))),r.a.createElement(g.a,null,r.a.createElement("div",{className:"container text-center"},t.active&&"Network"===t.connectorName&&r.a.createElement("p",null,"You do not currently have Metamask or Portis activated.  Please unlock Metamask or Portis in order to begin ENS domain registration process."))),"Network"!==t.connectorName&&r.a.createElement(E.a,{size:"lg",centered:!0,show:s,onHide:function(){return i(!1)}},r.a.createElement(E.a.Header,{closeButton:!0},r.a.createElement(E.a.Title,{id:"intro-modal"},"First time here?")),r.a.createElement(E.a.Body,null,r.a.createElement("h4",null,"What is ArwENS?"),r.a.createElement("p",null,"ArwENS is a one-stop shop for registering ENS domain/subdomains, storing text or web pages on Arweave, and then linking your newly minted ENS domain to your Arweave content."),r.a.createElement("h4",null,"What you need to get started"),r.a.createElement("ol",null,r.a.createElement("li",null," A Metamask or Portis wallet"),r.a.createElement("li",null," An Arweave wallet with some AR in it",r.a.createElement("br",null),r.a.createElement("span",null," Get a free one ",r.a.createElement("a",{href:"https://tokens.arweave.org",target:"_blank"},"here")," with 1 AR so you can try it out")),r.a.createElement("li",null," Something you want to host permanently on the permaweb")),r.a.createElement("h4",null,"How do I do this?"),r.a.createElement("p",null," The Dapp will walk you through it but below are the steps"),r.a.createElement("ol",null,r.a.createElement("li",null," Pick an ENS domain/subdomain to register and execute the transactions needed to register",r.a.createElement("br",null),r.a.createElement("span",null,"You'll be prompted a couple of times during the domain registration process.  If registering a domain name,the second transaction will include the total ETH required to register the domain for 1 year.")),r.a.createElement("li",null," Provide your Arweave key file",r.a.createElement("br",null),r.a.createElement("span",null,"Note, this key file is never leaving your device.  The Dapp is just using it to talk to Arweave.")),r.a.createElement("li",null," Upload your text/html file to the permaweb"),r.a.createElement("li",null," Link your ENS domain to your permanently hosted file"),r.a.createElement("li",null," Share your newly hosted page with everyone")))),r.a.createElement("div",{className:"container text-center"},(t.active&&"Network"===t.connectorName||t.error&&t.connectorName)&&r.a.createElement(w.a,{onClick:function(){return t.unsetConnector()}},t.active?"Retry Metamask":"Reset")))},N=n(10),C=n.n(N),S=n(312),k=n(50),A=n(306),O=n(311),D=n(121),M=n.n(D),j=n(12),T=[{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"resolver",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"label",type:"bytes32"},{name:"owner",type:"address"}],name:"setSubnodeOwner",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"ttl",type:"uint64"}],name:"setTTL",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"ttl",outputs:[{name:"",type:"uint64"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"resolver",type:"address"}],name:"setResolver",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"owner",type:"address"}],name:"setOwner",outputs:[],payable:!1,type:"function"},{inputs:[],payable:!1,type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"label",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"NewOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"resolver",type:"address"}],name:"NewResolver",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"ttl",type:"uint64"}],name:"NewTTL",type:"event"}],I=n(807),R=n(809),P=n(305),B=n(810),F=n(811),_=[{constant:!1,inputs:[],name:"renounceOwnership",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"",type:"bytes32"}],name:"commitments",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"MIN_REGISTRATION_DURATION",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"minCommitmentAge",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"isOwner",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"maxCommitmentAge",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{name:"_base",type:"address"},{name:"_prices",type:"address"},{name:"_minCommitmentAge",type:"uint256"},{name:"_maxCommitmentAge",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"name",type:"string"},{indexed:!0,name:"label",type:"bytes32"},{indexed:!0,name:"owner",type:"address"},{indexed:!1,name:"cost",type:"uint256"},{indexed:!1,name:"expires",type:"uint256"}],name:"NameRegistered",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"name",type:"string"},{indexed:!0,name:"label",type:"bytes32"},{indexed:!1,name:"cost",type:"uint256"},{indexed:!1,name:"expires",type:"uint256"}],name:"NameRenewed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"oracle",type:"address"}],name:"NewPriceOracle",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"previousOwner",type:"address"},{indexed:!0,name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{constant:!0,inputs:[{name:"name",type:"string"},{name:"duration",type:"uint256"}],name:"rentPrice",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"name",type:"string"}],name:"valid",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"name",type:"string"}],name:"available",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"name",type:"string"},{name:"owner",type:"address"},{name:"secret",type:"bytes32"}],name:"makeCommitment",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!1,inputs:[{name:"commitment",type:"bytes32"}],name:"commit",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"name",type:"string"},{name:"owner",type:"address"},{name:"duration",type:"uint256"},{name:"secret",type:"bytes32"}],name:"register",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!1,inputs:[{name:"name",type:"string"},{name:"duration",type:"uint256"}],name:"renew",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!1,inputs:[{name:"_prices",type:"address"}],name:"setPriceOracle",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_minCommitmentAge",type:"uint256"},{name:"_maxCommitmentAge",type:"uint256"}],name:"setCommitmentAges",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"withdraw",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"interfaceID",type:"bytes4"}],name:"supportsInterface",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"pure",type:"function"}];var L=function(e){var t=r.a.useState(""),n=Object(h.a)(t,2),a=n[0],o=n[1],s=M.a.init({host:"arweave.net",port:443,protocol:"https"});return console.log(e.arweaveHash),s.transactions.get(e.arweaveHash).then(function(e){e.get("tags").forEach(function(e){var t=e.get("name",{decode:!0,string:!0}),n=e.get("value",{decode:!0,string:!0});console.log("".concat(t," : ").concat(n))});var t=e.get("data",{decode:!0,string:!0});o(t),console.log(a)}).catch(function(e){console.log(e),o("error")}),"error"===a?r.a.createElement(r.a.Fragment,null,"error"===a&&r.a.createElement("p",null,"Still lost in the permaweb")):"router"===e.source?r.a.createElement("iframe",{width:"100%",height:"100%",frameborder:"0",srcdoc:a,src:"https://arweave.net/"+e.arweaveHash},">"):null},W=[{constant:!0,inputs:[{name:"interfaceID",type:"bytes4"}],name:"supportsInterface",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"data",type:"bytes"}],name:"setDNSRecords",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"},{name:"value",type:"string"}],name:"setText",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"interfaceID",type:"bytes4"}],name:"interfaceImplementer",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"contentTypes",type:"uint256"}],name:"ABI",outputs:[{name:"",type:"uint256"},{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],name:"setPubkey",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes"}],name:"setContenthash",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"addr",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"name",type:"bytes32"}],name:"hasDNSRecords",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"}],name:"text",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],name:"setABI",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"name",type:"string"}],name:"setName",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"name",type:"bytes32"},{name:"resource",type:"uint16"}],name:"dnsRecord",outputs:[{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"}],name:"clearDNSZone",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"contenthash",outputs:[{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"pubkey",outputs:[{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"addr",type:"address"}],name:"setAddr",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"interfaceID",type:"bytes4"},{name:"implementer",type:"address"}],name:"setInterface",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"",type:"bytes32"},{name:"",type:"address"},{name:"",type:"address"}],name:"authorisations",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{name:"_ens",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"target",type:"address"},{indexed:!1,name:"isAuthorised",type:"bool"}],name:"AuthorisationChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"indexedKey",type:"string"},{indexed:!1,name:"key",type:"string"}],name:"TextChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"x",type:"bytes32"},{indexed:!1,name:"y",type:"bytes32"}],name:"PubkeyChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"name",type:"string"}],name:"NameChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"interfaceID",type:"bytes4"},{indexed:!1,name:"implementer",type:"address"}],name:"InterfaceChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"name",type:"bytes"},{indexed:!1,name:"resource",type:"uint16"},{indexed:!1,name:"record",type:"bytes"}],name:"DNSRecordChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"name",type:"bytes"},{indexed:!1,name:"resource",type:"uint16"}],name:"DNSRecordDeleted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"}],name:"DNSZoneCleared",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"hash",type:"bytes"}],name:"ContenthashChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"a",type:"address"}],name:"AddrChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"contentType",type:"uint256"}],name:"ABIChanged",type:"event"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"target",type:"address"},{name:"isAuthorised",type:"bool"}],name:"setAuthorisation",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}],H=n(746);var G=function(e){var t=Object(c.useWeb3Context)(),n=r.a.useState(e.txid),a=Object(h.a)(n,2),o=a[0],s=a[1],i=r.a.useState(e.domainName),l=Object(h.a)(i,2),u=l[0],m=l[1],p=r.a.useState(!1),y=Object(h.a)(p,2),d=y[0],b=y[1],f=r.a.useState(),v=Object(h.a)(f,2),E=v[0],x=v[1];function N(){return(N=Object(k.a)(C.a.mark(function n(a){var r,o,s,i,l;return C.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.library.getSigner(),o=j.ethers.getDefaultProvider(),s=j.ethers.utils.namehash(e.domainName),console.log("Namehash of "+e.domainName+" is "+s),i=new j.ethers.Contract("0x5FfC014343cd971B7eb70732021E26C35B744cc4",W,r),n.next=7,o.getGasPrice();case 7:l=n.sent,i.setText(s,"url",a).then(function(e){console.log("Tx hash for setting Arweave hash is: "+e),b(!0)}).catch(function(e){console.log("Setting Arweave hash on ENS domain failed with error: "+e),m("error")}),i.setContenthash(s,"0x"+H.fromIpfs(e.ipfsCid),{gasLimit:3e5,gasPrice:l}).then(function(e){console.log(e),b(!0)}).catch(function(e){console.log("Setting IPFS content hash failed."),console.log(e),x(e),m("error")});case 10:case"end":return n.stop()}},n)}))).apply(this,arguments)}return t.active?r.a.createElement(r.a.Fragment,null,"Network"!==t.connectorName&&r.a.createElement("div",{className:"container mt-4 text-center"},r.a.createElement("h3",null,"Link ENS to hosted Arweave page")),"Network"!==t.connectorName&&r.a.createElement(R.a,{onSubmit:function(e){e.preventDefault(),function(e){N.apply(this,arguments)}(o)}},r.a.createElement(g.a,null,r.a.createElement(A.a,null,r.a.createElement(R.a.Group,{controlId:"ensDomain"},r.a.createElement(R.a.Label,null,"ENS Domain"),r.a.createElement(R.a.Control,{type:"text",defaultValue:e.domainName,placeholder:"alice.eth",onChange:function(e){m(e.target.value),console.log("Setting ensDomainName to "+u)}}),r.a.createElement(R.a.Text,{className:"text-muted"},"Enter the ENS domain or subdomain you wish to link to Arweave content"))),r.a.createElement(A.a,null,r.a.createElement(R.a.Group,{controlId:"arweaveId"},r.a.createElement(R.a.Label,null,"Arweave Transaction ID"),r.a.createElement(R.a.Control,{type:"text",defaultValue:e.txid,onChange:function(e){s(e.target.value),console.log("Setting URL to "+o)}}),r.a.createElement(R.a.Text,{className:"text-muted"},"Enter the Arweave transaction ID you want link to your ENS domain/subdomain")))),r.a.createElement(g.a,{className:"justify-content-md-center"},r.a.createElement(w.a,{variant:"primary",type:"submit"},"Link ENS to Arweave"),r.a.createElement(B.a,{show:"error"===u,key:"domainalert",variant:"danger"},"Something went wrong!  Please try again. ",JSON.stringify(E)))),r.a.createElement(g.a,null,r.a.createElement("div",{className:"container py-3 text-center"},r.a.createElement(w.a,{variant:"primary",type:"submit",onClick:function(){var e=j.ethers.utils.namehash(u);new j.ethers.Contract("0x5FfC014343cd971B7eb70732021E26C35B744cc4",W,t.library).text(e,"url").then(function(e){console.log(e),s(e)}).catch(function(e){console.log(e),s("none")})}},"Retrieve Arweave Resource"))),r.a.createElement(g.a,null,"none"!==o&&r.a.createElement("p",null,"The Arweave transction ID is: ",o)),r.a.createElement(g.a,null,d&&r.a.createElement("p",null,"Your page is now permanently hosted on the permaweb and can be accessed from anywhere by using the below URL.",window.location.href+e.domainName))):null};var U=function(e){var t=Object(c.useWeb3Context)(),n=r.a.useState(),a=Object(h.a)(n,2),o=a[0],s=a[1],i=r.a.useState(),l=Object(h.a)(i,2),u=l[0],m=l[1],p=r.a.useState({state:"Not Started",per:0}),y=Object(h.a)(p,2),d=y[0],b=y[1],f=r.a.useState(!0),v=Object(h.a)(f,2),E=v[0],x=v[1],N=r.a.useState(),S=Object(h.a)(N,2),O=S[0],D=S[1];function M(){return(M=Object(k.a)(C.a.mark(function e(){var n,a,r,s,i,l;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.library.getSigner(),a=o.split("."),r=j.ethers.utils.keccak256(j.ethers.utils.toUtf8Bytes(a[0])),s=j.ethers.utils.namehash(a[1]+"."+a[2]),console.log(r),i=new j.ethers.Contract("0x112234455c3a32fd11230c42e7bccd4a84e02010",T,n),b({state:"Registering subdomain",per:33}),e.next=9,i.setSubnodeOwner(s,r,i.owner(s));case 9:return l=e.sent,console.log(l),e.next=13,l.wait();case 13:return b({state:"Setting Resolver",per:66}),e.next=16,i.setResolver(j.ethers.utils.namehash(o),"0x5FfC014343cd971B7eb70732021E26C35B744cc4");case 16:l=e.sent,console.log(l),b({state:"Domain Registered",per:100}),D(o);case 20:case"end":return e.stop()}},e)}))).apply(this,arguments)}function L(){return(L=Object(k.a)(C.a.mark(function e(){var n,a,r,o,s,i,l,c,m,p,y,d;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.library.getSigner(),a=j.ethers.getDefaultProvider(),console.log("ENS Domain Name Hash is "+u),r=new j.ethers.Contract("0x357DBd063BeA7F0713BF88A3e97B7436B0235979",_,n),o=u.split(".")[0],e.next=7,r.available(o);case 7:if(s=e.sent,console.log(s),!1!==s){e.next=12;break}return x(!1),e.abrupt("return",console.log("Domain name unavailable"));case 12:return i=j.ethers.utils.formatBytes32String(o),e.next=15,r.makeCommitment(o,n._address,i);case 15:return l=e.sent,console.log("The commit hash for this registration request is "+l+" and the commit secret is "+i),e.next=19,r.rentPrice(o,31535999);case 19:return c=e.sent,console.log("ENS Domain Name Rent Price: "+c),b({state:"Committing Domain",per:33}),e.next=24,r.commit(l);case 24:return s=e.sent,console.log(s),e.next=28,s.wait();case 28:return e.next=30,r.minCommitmentAge();case 30:return m=e.sent,p=m.toNumber(),e.next=34,new Promise(function(e){return setTimeout(e,1e3*p)});case 34:return console.log("Waited "+p+" seconds"),e.next=37,a.getGasPrice();case 37:return y=e.sent,b({state:"Registering Domain",per:66}),e.next=41,r.register(o,n._address,j.ethers.utils.bigNumberify(31535999),i,{value:c,gasLimit:3e5,gasPrice:y});case 41:return s=e.sent,e.next=44,s.wait();case 44:return console.log("Registered "+u+" with transaction "+s),d=new j.ethers.Contract("0x112234455c3a32fd11230c42e7bccd4a84e02010",T,n),b({state:"Setting Resolver",per:90}),e.next=49,d.setResolver(j.ethers.utils.namehash(u),"0x5FfC014343cd971B7eb70732021E26C35B744cc4");case 49:return s=e.sent,e.next=52,s.wait();case 52:console.log(s),b({state:"Domain Registered",per:100}),D(u);case 55:case"end":return e.stop()}},e)}))).apply(this,arguments)}return t.active&&"Network"!==t.connectorName?r.a.createElement(I.a,null,r.a.createElement(g.a,null,r.a.createElement(A.a,null,r.a.createElement(R.a,{onSubmit:function(e){e.preventDefault(),function(){return L.apply(this,arguments)}().catch(function(e){b({state:"",per:0}),console.log(e)})}},r.a.createElement(P.a,{placeholder:"alice.eth","aria-label":"ENSDomain",type:"text",value:u,onChange:function(e){m(e.target.value),x(!0),console.log("Setting ENS Domain Name to "+u)},"aria-describedby":"basic-addon1"}),r.a.createElement(R.a.Text,{className:"text-muted"},"3 Transactions - Commit; Register Domain; Set resolver"),r.a.createElement("div",{className:"container pt-2 text-center "},r.a.createElement(w.a,{type:"submit",disabled:d.per>0},d.per>0?"Registering Domain":"Register Domain"),r.a.createElement(B.a,{show:!E,key:"domainalert",variant:"danger"},"That ENS domain name is not available")))),r.a.createElement(A.a,null,r.a.createElement(R.a,{onSubmit:function(e){e.preventDefault(),function(){M.apply(this,arguments)}()}},r.a.createElement(P.a,{type:"text",value:o,onChange:function(e){s(e.target.value),D(o),console.log("Setting ENS Domain Name to "+o)},placeholder:"bob.alice.eth",className:" mr-sm-2"}),r.a.createElement(R.a.Text,{className:"text-muted"},"2 Transactions - Register Subdomain; Set resolver"),r.a.createElement("div",{className:"container pt-2 text-center "},r.a.createElement(w.a,{type:"submit",disabled:d.per>0},"Register Subdomain"))))),r.a.createElement(g.a,null,d.per>0&&r.a.createElement("div",{className:"container text-center"},r.a.createElement(F.a,{now:d.per,label:d.state}))),100===d.per&&r.a.createElement(g.a,null,r.a.createElement(A.a,null,r.a.createElement(G,{domainName:O,txid:e.txid,ipfsCid:e.ipfsCid})))):null},J=n(307),K=n.n(J),V=n(779),Y={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderWidth:1,borderRadius:1,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#bdbdbd",outline:"none",transition:"border .24s ease-in-out"},q={borderColor:"#2196f3"},z={borderColor:"#00e676"},Z={borderColor:"#ff1744"};var $=function(e){var t=Object(c.useWeb3Context)(),n=r.a.useState(),o=Object(h.a)(n,2),s=o[0],i=o[1],l=r.a.useState(),u=Object(h.a)(l,2),m=u[0],p=u[1],y=r.a.useState(),d=Object(h.a)(y,2),b=d[0],f=d[1],v=r.a.useState(""),E=Object(h.a)(v,2),x=E[0],N=E[1],D=r.a.useState(),j=Object(h.a)(D,2),T=j[0],I=j[1];r.a.useEffect(function(){s&&function(e){return G.apply(this,arguments)}(s).then(function(e){return p(e)})});var R=M.a.init({host:"arweave.net",port:443,protocol:"https"}),P=Object(a.useCallback)(function(e){console.log(e);var t=new FileReader;t.onabort=function(){return console.log("file reading was aborted")},t.onerror=function(){return console.log("file reading has failed")},t.onload=function(t){if("application/json"===e[0].type){var n=JSON.parse(t.target.result);R.wallets.jwkToAddress(n).then(function(e){i({privateKey:n,address:e})})}else{var a=t.target.result;f(a);var r=new K.a("file",a),o=new V.DAGNode(r.marshal());V.util.cid(V.util.serialize(o),{cidVersion:0}).then(function(t){I(t.toBaseEncodedString()),console.log("IPFS CID for this transaction is: "+T),function(e,t,n){return J.apply(this,arguments)}(s.privateKey,a,{name:"Content-Type",value:e[0].type,cid:t}).then(function(e){return N(e)})})}},t.readAsText(e[0])},[s,b]),B=Object(O.a)({onDrop:P,accept:"application/json , text/html , text/plain"}),F=B.isDragActive,_=B.isDragAccept,L=B.getRootProps,W=B.getInputProps,H=B.isDragReject;function G(){return(G=Object(k.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.wallets.getBalance(t.address);case 2:return n=e.sent,console.log("Wallet balance is currently "+R.ar.winstonToAr(n)),e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function J(){return(J=Object(k.a)(C.a.mark(function e(t,n,a){var r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(n),e.next=3,R.createTransaction({data:n},t);case 3:return(r=e.sent).addTag(a.name,a.value),r.addTag("IPFS-Add",a.cid),console.log("This transaction will cost "+r.reward+" winston"),e.next=9,R.transactions.sign(r,s.privateKey);case 9:return console.log(r),e.abrupt("return",r);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function $(){return($=Object(k.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,R.transactions.post(t);case 3:return n=e.sent,console.log(n),f(),e.abrupt("return",n.status);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}B.acceptedFiles;var Q=Object(a.useMemo)(function(){return Object(S.a)({},Y,F?q:{},_?z:{},H?Z:{})},[F,H]);return t.active&&"Network"!==t.connectorName?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container mt-3 text-center"},r.a.createElement("h3",null,"Arweave registration/file deployment")),!s&&r.a.createElement("div",{className:"container text-center mt-5"},r.a.createElement("div",L({style:Q}),r.a.createElement("input",W()),!F&&"Click here or drop your Arweave keyfile here to connect to Arweave",F&&!H&&"Drop keyfile here",H&&"Please only drop your keyfile ")),r.a.createElement("div",{className:"container text-left"},s&&r.a.createElement("p",null,"Arweave wallet address: ",s.address)),r.a.createElement("div",{className:"container text-left"},m&&r.a.createElement("p",null,"Arweave wallet balance: ",m," winston")),s&&m&&!b&&r.a.createElement("div",{className:"container text-center mt-5"},r.a.createElement("div",L({style:Q}),r.a.createElement("input",W()),!F&&"Click here or drop a file to deploy to Arweave.",F&&!H&&"Drop file here",H&&"Please only drop HTML or Text files here")),x&&r.a.createElement("ul",null,r.a.createElement("li",null,"Transaction ID: ",r.a.createElement("a",{href:"https://arweave.net/tx/"+x.id,target:"_blank"},x.id)),r.a.createElement("li",null,"Transaction Cost: ",x.reward," winston"),r.a.createElement("li",null,"IPFS CID: ",T)),r.a.createElement(g.a,null,x&&r.a.createElement(A.a,null,r.a.createElement("div",{className:"container pt-1"},r.a.createElement(w.a,{key:"submitTxn",onClick:function(){return function(e){return $.apply(this,arguments)}(x)}},"Submit Transaction"))),x&&r.a.createElement(A.a,null,r.a.createElement("div",{className:"container pt-1"},r.a.createElement(w.a,{key:"reset",onClick:function(){f(),N("")}},"Start Over")))),""!==x&&r.a.createElement(g.a,null,r.a.createElement(U,{txid:x.id,ipfsCid:T}))):null};var Q=function(e){var t=Object(c.useWeb3Context)(),n=r.a.useState("none"),a=Object(h.a)(n,2),o=a[0],s=a[1],i=r.a.useState(e.domainName),l=Object(h.a)(i,2),u=l[0];return l[1],t.active?(function(){var e=j.ethers.utils.namehash(u);new j.ethers.Contract("0x5FfC014343cd971B7eb70732021E26C35B744cc4",W,t.library).text(e,"url").then(function(e){console.log(e),s(e)}).catch(function(e){console.log(e),s("none")})}(),r.a.createElement(r.a.Fragment,null,r.a.createElement(L,{arweaveHash:o,source:"router"}))):r.a.createElement("p",null,"No Web3 connection found")};var X=function(){return r.a.createElement(i.a,null,r.a.createElement(l.c,null,r.a.createElement(l.a,{exact:!0,path:"/",render:function(){return r.a.createElement(u.a,{connectors:f,libraryName:"ethers.js"},r.a.createElement(I.a,{className:"App"},r.a.createElement(g.a,null,r.a.createElement("div",{className:"container text-center"},r.a.createElement("h1",null,"ArwENS"))),r.a.createElement(g.a,null,r.a.createElement("div",{className:"container text-center"},"A simple Dapp for registering ENS domains and linking to content hosted on Arweave")),r.a.createElement(g.a,null,r.a.createElement(A.a,null,r.a.createElement(x,null))),r.a.createElement(g.a,null,r.a.createElement(A.a,null,r.a.createElement($,null)))))}}),r.a.createElement(l.a,{path:"/:id",render:function(e){return r.a.createElement(u.a,{connectors:f,libraryName:"ethers.js"},r.a.createElement(g.a,null,r.a.createElement(A.a,null,r.a.createElement(x,{source:"router"}),r.a.createElement(Q,{domainName:e.match.params.id}))))}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(X,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[313,1,2]]]);
//# sourceMappingURL=main.d2dd14d3.chunk.js.map